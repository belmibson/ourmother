<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Our Mother</title>

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/base.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    <script src="js/Three.js"></script>
    <script src="js/Detector.js"></script>
    <script src="js/OrbitControls.js"></script>
    <script src="js/THREEx.KeyboardState.js"></script>
    <script src="js/THREEx.FullScreen.js"></script>
    <script src="js/THREEx.WindowResize.js"></script>

    <script id="vertexShader" type="x-shader/x-vertex">
    uniform sampler2D noiseTexture;
    uniform float noiseScale;

    uniform sampler2D bumpTexture;
    uniform float bumpSpeed;
    uniform float bumpScale;

    uniform float time;

    varying vec2 vUv;

    void main()
    {
        vUv = uv;

      vec2 uvTimeShift = vUv + vec2( 1.1, 1.9 ) * time * bumpSpeed;
      vec4 noiseGeneratorTimeShift = texture2D( noiseTexture, uvTimeShift );
      vec2 uvNoiseTimeShift = vUv + noiseScale * vec2( noiseGeneratorTimeShift.r, noiseGeneratorTimeShift.g );
      // below, using uvTimeShift seems to result in more of a "rippling" effect
      //   while uvNoiseTimeShift seems to result in more of a "shivering" effect
      vec4 bumpData = texture2D( bumpTexture, uvTimeShift );

      // move the position along the normal
      //  but displace the vertices at the poles by the same amount
      float displacement = ( vUv.y > 0.999 || vUv.y < 0.001 ) ?
        bumpScale * (0.3 + 0.02 * sin(time)) :
        bumpScale * bumpData.r;
        vec3 newPosition = position + normal * displacement;

      gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
    }
    </script>

    <!-- fragment shader a.k.a. pixel shader -->
    <script id="fragmentShader" type="x-shader/x-vertex">
    uniform sampler2D baseTexture;
    uniform float baseSpeed;
    uniform float repeatS;
    uniform float repeatT;

    uniform sampler2D noiseTexture;
    uniform float noiseScale;

    uniform sampler2D blendTexture;
    uniform float blendSpeed;
    uniform float blendOffset;

    uniform float time;
    uniform float alpha;

    varying vec2 vUv;

    void main()
    {
      vec2 uvTimeShift = vUv + vec2( -0.7, 1.5 ) * time * baseSpeed;
      vec4 noiseGeneratorTimeShift = texture2D( noiseTexture, uvTimeShift );
      vec2 uvNoiseTimeShift = vUv + noiseScale * vec2( noiseGeneratorTimeShift.r, noiseGeneratorTimeShift.b );
      vec4 baseColor = texture2D( baseTexture, uvNoiseTimeShift * vec2(repeatS, repeatT) );

      vec2 uvTimeShift2 = vUv + vec2( 1.3, -1.7 ) * time * blendSpeed;
      vec4 noiseGeneratorTimeShift2 = texture2D( noiseTexture, uvTimeShift2 );
      vec2 uvNoiseTimeShift2 = vUv + noiseScale * vec2( noiseGeneratorTimeShift2.g, noiseGeneratorTimeShift2.b );
      vec4 blendColor = texture2D( blendTexture, uvNoiseTimeShift2 * vec2(repeatS, repeatT) ) - blendOffset * vec4(1.0, 1.0, 1.0, 1.0);

      vec4 theColor = baseColor + blendColor;
      theColor.a = alpha;
      gl_FragColor = theColor;
    }
    </script>


    <div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div>

    <script src="js/custom.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/stratus.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
        $.stratus({
            links: 'https://soundcloud.com/ellie-5/the-beach-boys-i-get-around',
            auto_play: true,
        });
    });
    </script>
    <script>

    window.onresize = function(event) {
        if (window.innerWidth < 700){
            $('#stratus').hide();
        }
        if (window.innerWidth > 700){
            $('#stratus').show();
        }

    };

    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49498124-1', 'ourmother.co.uk');
  ga('send', 'pageview');

</script>

    </body>
</html>
